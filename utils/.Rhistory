# ==== Loading packages ====
library(tidyverse)
# ==== Loading packages ====
library(tidyverse)
library(lmerTest)
library(lubridate)
# ==== Reading data ====
pwi_data <- read_csv("pwi_data_clean_withpreds.csv")
# ==== Reading data ====
pwi_data <- read_csv("../pwi_data_clean_withpreds.csv")
demo <- read_csv("../data/demo.csv") %>%
mutate(Birth.date = dmy(Birth.date),
Onset.date = dmy(Onset.date),
Behaviour.date = dmy(Behaviour.date),
Age = (Birth.date %--% Behaviour.date)/dyears(x = 1),
Post.onset.weeks = (Onset.date %--% Behaviour.date)/dweeks(x = 1))
pwi_data <- pwi_data %>%
left_join(demo %>% select(ID, Age, Sex, Post.onset.weeks))
# z-scoring continuous predictors
frontal_subset <- c("POper", "PTri", "PreCG", "SLF_I", "SLF_II")
pred_to_zscore <- c("Age", "Post.onset.weeks", "consec_dissimilarity", "logfreq", frontal_subset)
pwi_data[pred_to_zscore] = scale(pwi_data[pred_to_zscore],
center=TRUE, scale=TRUE)
print("z-scoring continuous predictors:")
print(pred_to_zscore)
# sum-coding gender
pwi_data$Sex <- as.factor(pwi_data$Sex)
contrasts(pwi_data$Sex) <- contr.sum(levels(pwi_data$Sex))
print("gender coding:")
print(contrasts(pwi_data$Sex))
# re-leveling the condition variable
pwi_data$Condition <- relevel(as.factor(pwi_data$Condition), "semantic")
print("condition coding:")
print(contrasts(pwi_data$Condition))
#==== Model fitting ====
pwi_model <- lmer(data = pwi_data,
logRT ~
POper*(Condition + consec_dissimilarity) +
PTri*(Condition + consec_dissimilarity) +
SLF_I*(Condition + consec_dissimilarity) +
SLF_II*(Condition + consec_dissimilarity) +
PreCG*(Condition + consec_dissimilarity) +
logfreq + Age + Sex + Post.onset.weeks +
(1|ID) + (1|Critical.segment),
control=lmerControl(optimizer="bobyqa"))
#==== Model fitting ====
pwi_model <- lmer(data = pwi_data,
logRT ~
POper*(Condition + consec_dissimilarity) +
PTri*(Condition + consec_dissimilarity) +
SLF_I*(Condition + consec_dissimilarity) +
SLF_II*(Condition + consec_dissimilarity) +
PreCG*(Condition + consec_dissimilarity) +
logfreq + Age + Sex + Post.onset.weeks +
(1 + Condition + consec_dissimilarity|ID) + (1|Critical.segment),
control=lmerControl(optimizer="bobyqa"))
#==== Model fitting ====
pwi_model <- lmer(data = pwi_data,
logRT ~
POper*(Condition + consec_dissimilarity) +
PTri*(Condition + consec_dissimilarity) +
SLF_I*(Condition + consec_dissimilarity) +
SLF_II*(Condition + consec_dissimilarity) +
PreCG*(Condition + consec_dissimilarity) +
logfreq + Age + Sex + Post.onset.weeks +
(1 + Condition + consec_dissimilarity|ID),
control=lmerControl(optimizer="bobyqa"))
#==== Model fitting ====
pwi_model <- lmer(data = pwi_data,
logRT ~
POper*(Condition + consec_dissimilarity) +
PTri*(Condition + consec_dissimilarity) +
SLF_I*(Condition + consec_dissimilarity) +
SLF_II*(Condition + consec_dissimilarity) +
PreCG*(Condition + consec_dissimilarity) +
logfreq + Age + Sex + Post.onset.weeks +
(1|ID) + (1|Critical.segment),
control=lmerControl(optimizer="bobyqa"))
pwi_model_ranef <- lmer(data = pwi_data,
logRT ~
POper*(Condition + consec_dissimilarity) +
PTri*(Condition + consec_dissimilarity) +
SLF_I*(Condition + consec_dissimilarity) +
SLF_II*(Condition + consec_dissimilarity) +
PreCG*(Condition + consec_dissimilarity) +
logfreq + Age + Sex + Post.onset.weeks +
(1 + Condition + consec_dissimilarity|ID) + (1|Critical.segment),
control=lmerControl(optimizer="bobyqa"))
#==== Model fitting ====
pwi_model <- lmer(data = pwi_data,
logRT ~
POper*(Condition + consec_dissimilarity) +
PTri*(Condition + consec_dissimilarity) +
SLF_I*(Condition + consec_dissimilarity) +
SLF_II*(Condition + consec_dissimilarity) +
PreCG*(Condition + consec_dissimilarity) +
logfreq + Age + Sex + Post.onset.weeks +
(1|ID) + (1|Critical.segment),
control=lmerControl(optimizer="bobyqa"))
pwi_model_ranef <- lmer(data = pwi_data,
logRT ~
POper*(Condition + consec_dissimilarity) +
PTri*(Condition + consec_dissimilarity) +
SLF_I*(Condition + consec_dissimilarity) +
SLF_II*(Condition + consec_dissimilarity) +
PreCG*(Condition + consec_dissimilarity) +
logfreq + Age + Sex + Post.onset.weeks +
(1 + Condition + consec_dissimilarity|ID) + (1|Critical.segment),
control=lmerControl(optimizer="bobyqa"))
summary(pwi_model)
summary(pwi_model_ranef)
print(car::vif(pwi_model_ranef))
print(car::vif(pwi_model))
# model with continuous target-distractor dissimilarity
print("fitting a model with continuous target-distractor dissimilarity")
pwi_model_distrcont <- lmer(data = pwi_data %>% filter(Condition != "congr"),
logRT ~
POper*(distr_dissimilarity + consec_dissimilarity) +
PTri*(distr_dissimilarity + consec_dissimilarity) +
SLF_I*(distr_dissimilarity + consec_dissimilarity) +
SLF_II*(distr_dissimilarity + consec_dissimilarity) +
PreCG*(distr_dissimilarity + consec_dissimilarity) +
Age + Sex + Post.onset.weeks + logfreq +
(1|ID) + (1|Critical.segment),
control=lmerControl(optimizer="bobyqa"))
print("variance inflation factors:")
print(car::vif(pwi_model_distrcont))
print(summary(pwi_model_distrcont))
# re-leveling the condition variable
pwi_data["Condition_sumcontr"] <- pwi_data$Condition
contrasts(pwi_data$Condition_sumcontr) <- contr.sum(levels(pwi_data$Condition_sumcontr))
print("condition coding:")
print(contrasts(pwi_data$Condition_sumcontr))
pwi_model_condsum <- lmer(data = pwi_data,
logRT ~
POper*(Condition_sumcontr + consec_dissimilarity) +
PTri*(Condition_sumcontr + consec_dissimilarity) +
SLF_I*(Condition_sumcontr + consec_dissimilarity) +
SLF_II*(Condition_sumcontr + consec_dissimilarity) +
PreCG*(Condition_sumcontr + consec_dissimilarity) +
logfreq + Age + Sex + Post.onset.weeks +
(1|ID) + (1|Critical.segment),
control=lmerControl(optimizer="bobyqa"))
print("variance inflation factors:")
print(car::vif(pwi_model_condsum))
print(summary(pwi_model_condsum))
View(demo)
View(demo)
# ==== Loading packages ====
library(tidyverse)
library(lmerTest)
library(lubridate)
# ==== Reading data ====
pwi_data <- read_csv("pwi_data_clean_withpreds.csv")
# ==== Reading data ====
pwi_data <- read_csv("../pwi_data_clean_withpreds.csv")
demo <- read_csv("../data/demo.csv") %>%
mutate(Birth.date = dmy(Birth.date),
Onset.date = dmy(Onset.date),
Behaviour.date = dmy(Behaviour.date),
Age = (Birth.date %--% Behaviour.date)/dyears(x = 1),
Post.onset.weeks = (Onset.date %--% Behaviour.date)/dweeks(x = 1))
demo <- read_csv("../data/demo.csv") %>%
mutate(Birth.date = dmy(Birth.date),
Onset.date = dmy(Onset.date),
Behaviour.date = dmy(Behaviour.date),
Age = (Birth.date %--% Behaviour.date)/dyears(x = 1),
Post.onset.weeks = (Onset.date %--% Behaviour.date)/dweeks(x = 1),
Post.onset.months = (Onset.date %--% Behaviour.date)/dmonths(x = 1))
View(demo)
mean(demo$Post.onset.months)
sd(demo$Post.onset.months)
min(demo$Post.onset.months)
max(demo$Post.onset.months)
View(demo)
demo <- read_csv("../data/demo.csv") %>%
mutate(Birth.date = dmy(Birth.date),
MRI.date = dmy(MRI.date),
Onset.date = dmy(Onset.date),
Behaviour.date = dmy(Behaviour.date),
Age = (Birth.date %--% Behaviour.date)/dyears(x = 1),
Post.onset.weeks = (Onset.date %--% Behaviour.date)/dweeks(x = 1),
Post.onset.months = (Onset.date %--% Behaviour.date)/dmonths(x = 1),
Behav.mri.weeks = (MRI.date %--% Behaviour.date)/dweeks(x = 1))
View(demo)
# ==== Loading packages ====
library(tidyverse)
library(lmerTest)
library(lubridate)
# ==== Reading data ====
pwi_data <- read_csv("../pwi_data_clean_withpreds.csv")
demo <- read_csv("../data/demo.csv") %>%
mutate(Birth.date = dmy(Birth.date),
MRI.date = dmy(MRI.date),
Onset.date = dmy(Onset.date),
Behaviour.date = dmy(Behaviour.date),
Age = (Birth.date %--% Behaviour.date)/dyears(x = 1),
Post.onset.weeks = (Onset.date %--% Behaviour.date)/dweeks(x = 1),
Post.onset.months = (Onset.date %--% Behaviour.date)/dmonths(x = 1),
Behav.mri.weeks = (MRI.date %--% Behaviour.date)/dweeks(x = 1))
median(demo$Post.onset.months)
median(Behav.mri.weeks)
median(demo$Behav.mri.weeks)
mean(demo$Behav.mri.weeks)
min(demo$Behav.mri.weeks)
median(abs(demo$Behav.mri.weeks))
abs(demo$Behav.mri.weeks)
View(demo)
median(abs(demo$Behav.mri.weeks))
mean(abs(demo$Behav.mri.weeks))
min(abs(demo$Behav.mri.weeks))
max(abs(demo$Behav.mri.weeks))
demo_subacute <- demo %>%
filter(Post.onset.weeks<=48)
demo_subacute <- demo %>%
filter(Post.onset.weeks<48)
demo_subacute <- demo %>%
filter(Post.onset.weeks<=48)
View(demo_subacute)
mean(abs(demo_subacute$Behav.mri.weeks))
median(abs(demo_subacute$Behav.mri.weeks))
median(abs(demo_subacute$Behav.mri.weeks))
sd(abs(demo_subacute$Behav.mri.weeks))
sd(abs(demo$Behav.mri.weeks))
max(abs(demo$Behav.mri.weeks))
# ==== Loading packages ====
library(tidyverse)
library(lmerTest)
library(lubridate)
# ==== Reading data ====
pwi_data <- read_csv("../pwi_data_clean_withpreds.csv")
demo <- read_csv("../data/demo.csv") %>%
mutate(Birth.date = dmy(Birth.date),
Onset.date = dmy(Onset.date),
Behaviour.date = dmy(Behaviour.date),
Age = (Birth.date %--% Behaviour.date)/dyears(x = 1),
Post.onset.weeks = (Onset.date %--% Behaviour.date)/dweeks(x = 1))
pwi_data <- pwi_data %>%
left_join(demo %>% select(ID, Age, Sex, Post.onset.weeks))
# z-scoring continuous predictors
frontal_subset <- c("POper", "PTri", "PreCG", "SLF_I", "SLF_II")
pred_to_zscore <- c("Age", "Post.onset.weeks",
"consec_dissimilarity", "distr_dissimilarity", "logfreq", frontal_subset)
pwi_data[pred_to_zscore] = scale(pwi_data[pred_to_zscore],
center=TRUE, scale=TRUE)
print("z-scoring continuous predictors:")
print(pred_to_zscore)
# sum-coding gender
pwi_data$Sex <- as.factor(pwi_data$Sex)
contrasts(pwi_data$Sex) <- contr.sum(levels(pwi_data$Sex))
print("gender coding:")
print(contrasts(pwi_data$Sex))
# re-leveling the condition variable
pwi_data$Condition <- relevel(as.factor(pwi_data$Condition), "semantic")
print("condition coding:")
print(contrasts(pwi_data$Condition))
#==== Model fitting ====
pwi_model <- lmer(data = pwi_data,
logRT ~
POper*(Condition + consec_dissimilarity) +
PTri*(Condition + consec_dissimilarity) +
SLF_I*(Condition + consec_dissimilarity) +
SLF_II*(Condition + consec_dissimilarity) +
PreCG*(Condition + consec_dissimilarity) +
logfreq + Age + Sex + Post.onset.weeks +
(1|ID) + (1|Critical.segment),
control=lmerControl(optimizer="bobyqa"))
print("variance inflation factors:")
print(car::vif(pwi_model))
print(summary(pwi_model))
# model with continuous target-distractor dissimilarity
print("fitting a model with continuous target-distractor dissimilarity")
pwi_model_distrcont <- lmer(data = pwi_data %>% filter(Condition != "congr"),
logRT ~
POper*(distr_dissimilarity + consec_dissimilarity) +
PTri*(distr_dissimilarity + consec_dissimilarity) +
SLF_I*(distr_dissimilarity + consec_dissimilarity) +
SLF_II*(distr_dissimilarity + consec_dissimilarity) +
PreCG*(distr_dissimilarity + consec_dissimilarity) +
Age + Sex + Post.onset.weeks + logfreq +
(1|ID) + (1|Critical.segment),
control=lmerControl(optimizer="bobyqa"))
print("variance inflation factors:")
print(car::vif(pwi_model_distrcont))
print(summary(pwi_model_distrcont))
# ==== Reading data ====
pwi_data <- read_csv("../pwi_data_clean_withpreds.csv")
demo <- read_csv("../data/demo.csv") %>%
mutate(Birth.date = dmy(Birth.date),
Onset.date = dmy(Onset.date),
Behaviour.date = dmy(Behaviour.date),
Age = (Birth.date %--% Behaviour.date)/dyears(x = 1),
Post.onset.weeks = (Onset.date %--% Behaviour.date)/dweeks(x = 1))
# ==== Loading packages ====
library(tidyverse)
library(lmerTest)
library(lubridate)
# ==== Reading data ====
pwi_data <- read_csv("../pwi_data_clean_withpreds.csv")
demo <- read_csv("../data/demo.csv") %>%
mutate(Birth.date = dmy(Birth.date),
Onset.date = dmy(Onset.date),
Behaviour.date = dmy(Behaviour.date),
Age = (Birth.date %--% Behaviour.date)/dyears(x = 1),
Post.onset.weeks = (Onset.date %--% Behaviour.date)/dweeks(x = 1))
min(demo$Age)
# ==== Loading packages ====
library(tidyverse)
library(lmerTest)
library(lubridate)
# ==== Reading data ====
pwi_data <- read_csv("../pwi_data_clean_withpreds.csv")
demo <- read_csv("../data/demo.csv") %>%
mutate(Birth.date = dmy(Birth.date),
Onset.date = dmy(Onset.date),
Behaviour.date = dmy(Behaviour.date),
Age = (Birth.date %--% Behaviour.date)/dyears(x = 1),
Post.onset.weeks = (Onset.date %--% Behaviour.date)/dweeks(x = 1))
pwi_data <- pwi_data %>%
left_join(demo %>% select(ID, Age, Sex, Post.onset.weeks))
# z-scoring continuous predictors
frontal_subset <- c("POper", "PTri", "PreCG", "SLF_I", "SLF_II")
pred_to_zscore <- c("Age", "Post.onset.weeks",
"consec_dissimilarity", "distr_dissimilarity", "logfreq", frontal_subset)
pwi_data[pred_to_zscore] = scale(pwi_data[pred_to_zscore],
center=TRUE, scale=TRUE)
print("z-scoring continuous predictors:")
print(pred_to_zscore)
# sum-coding gender
pwi_data$Sex <- as.factor(pwi_data$Sex)
contrasts(pwi_data$Sex) <- contr.sum(levels(pwi_data$Sex))
print("gender coding:")
print(contrasts(pwi_data$Sex))
# re-leveling the condition variable
pwi_data$Condition <- relevel(as.factor(pwi_data$Condition), "semantic")
print("condition coding:")
print(contrasts(pwi_data$Condition))
#==== Model fitting ====
pwi_model <- lmer(data = pwi_data,
logRT ~
POper*(Condition + consec_dissimilarity) +
PTri*(Condition + consec_dissimilarity) +
SLF_I*(Condition + consec_dissimilarity) +
SLF_II*(Condition + consec_dissimilarity) +
PreCG*(Condition + consec_dissimilarity) +
logfreq + Age + Sex + Post.onset.weeks +
(1|ID) + (1|Critical.segment),
control=lmerControl(optimizer="bobyqa"))
print("variance inflation factors:")
print(car::vif(pwi_model))
print(summary(pwi_model))
# model with continuous target-distractor dissimilarity
print("fitting a model with continuous target-distractor dissimilarity")
pwi_model_distrcont <- lmer(data = pwi_data %>% filter(Condition != "congr"),
logRT ~
POper*(distr_dissimilarity + consec_dissimilarity) +
PTri*(distr_dissimilarity + consec_dissimilarity) +
SLF_I*(distr_dissimilarity + consec_dissimilarity) +
SLF_II*(distr_dissimilarity + consec_dissimilarity) +
PreCG*(distr_dissimilarity + consec_dissimilarity) +
Age + Sex + Post.onset.weeks + logfreq +
(1|ID) + (1|Critical.segment),
control=lmerControl(optimizer="bobyqa"))
print("variance inflation factors:")
print(car::vif(pwi_model_distrcont))
print(summary(pwi_model_distrcont))
View(pwi_model)
View(pwi_model_distrcont)
View(pwi_model)
# saving model predictions
a <- predict(pwi_model)
# saving model predictions
a <- predict(pwi_model, newdata = pwi_data)
# saving model predictions
pwi_data["prediction_condmodel"] <- predict(pwi_model, newdata = pwi_data)
pwi_data["prediction_distrcontmodel"] <- predict(pwi_model_distrcont, newdata = pwi_data)
# saving model predictions
pwi_data["lmer_prediction"] <- predict(pwi_model, newdata = pwi_data)
plot(pwi_data$logRT, pwi_data$lmer_prediction)
plot(pwi_model)
write_csv(pwi_data, "lmer_predictions.csv")
